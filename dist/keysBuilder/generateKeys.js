"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.generateKeys=void 0;const flat_1=require("flat"),glob=__importStar(require("glob")),nodePath=__importStar(require("path")),mergeDeep_1=require("../helpers/mergeDeep"),readFile_1=require("../helpers/readFile"),writeFile_1=require("../helpers/writeFile");function filterLangs(e){return function(t){return e.langs.find(e=>e===nodePath.basename(t).replace(".json",""))}}function generateKeys({translationPath:e,scopeToKeys:t,config:r}){const n=r.scopePathMap||{};let i=[];for(const[e,o]of Object.entries(n)){const n=t[e];n&&i.push({keys:n,files:glob.sync(`${o}/*.json`).filter(filterLangs(r))})}for(const[n,o]of Object.entries(t))if(o){const t="__global"===n;i.push({keys:o,files:glob.sync(`${e}/${t?"":n}*.json`).filter(filterLangs(r))})}for(let{files:e,keys:t}of i){r.unflat&&(t=flat_1.unflatten(t));for(const r of e){const e=readFile_1.readFile(r,{parse:!0});writeFile_1.writeFile(r,mergeDeep_1.mergeDeep({},t,e))}}}exports.generateKeys=generateKeys;