"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TSExtractor=void 0;const tsquery_1=require("@phenomnomnominal/tsquery"),readFile_1=require("../helpers/readFile"),regexs_1=require("../regexs"),addKey_1=require("./addKey"),commentsSectionExtractor_1=require("./commentsSectionExtractor"),extractTSMarkerKeys_1=require("./extractTSMarkerKeys"),extractTSPureKeys_1=require("./extractTSPureKeys"),extractTsServiceKeys_1=require("./extractTsServiceKeys"),resolveScopeAlias_1=require("./resolveScopeAlias");function TSExtractor({file:e,scopes:r,defaultValue:t,scopeToKeys:s}){const c=readFile_1.readFile(e),a=[];if(c.includes("@ngneat/transloco")&&a.push(extractTsServiceKeys_1.extractServiceKeys,extractTSPureKeys_1.extractPureKeys),c.includes("@ngneat/transloco-keys-manager")&&a.push(extractTSMarkerKeys_1.extractMarkerKeys),0===a.length)return s;const o=tsquery_1.tsquery.ast(c),i={scopeToKeys:s,scopes:r,defaultValue:t};return a.map(e=>e(o)).flat().forEach(({key:e,lang:t})=>{const[s,c]=resolveAliasAndKeyFromService(e,t,r);addKey_1.addKey(Object.assign({scopeAlias:c,keyWithoutScope:s},i))}),commentsSectionExtractor_1.extractCommentsValues(Object.assign({content:c,regex:regexs_1.regexs.tsCommentsSection},i)),s}function resolveAliasAndKeyFromService(e,r,t){if(!r)return[e,null];return[e,resolveScopeAlias_1.resolveScopeAlias({scopePath:r,scopes:t})]}exports.TSExtractor=TSExtractor;